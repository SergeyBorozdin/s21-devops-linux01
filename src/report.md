Part 1. Установка ОС
=====================
== Задание ==
--------------
- Установить Ubuntu 20.04 Server LTS без графического интерфейса. (Используем программу для виртуализации - VirtualBox)
- Графический интерфейс должен отсутствовать.
- Узнайте версию Ubuntu, выполнив команду 
cat /etc/issue.
- Вставьте скриншот с выводом команды.

== Решение ==
--------------
- установил **VirtualBox**
- Cкачал образ диска **Ubuntu** с <https://ubuntu.com/download/server>
- Установил через **VirtualBox**
- Результат команды
>       cat ../../etc/issue.net
![id1](src/image/Part1.png)


Part 2. Создание пользователя
===========================
== Задание ==
--------------

- Создать пользователя, отличного от пользователя, который создавался при установке. Пользователь должен быть добавлен в группу adm.
- Вставьте скриншот вызова команды для создания пользователя.
- Новый пользователь должен быть в выводе команды cat /etc/passwd
- Вставьте скриншот с выводом команды.

== Решение ==
--------------
- Добавляем нового пользователя командой
>       sudo adduser user2
- Интерфейс предложит заполнить различные данные на пользователя
![id2](src/image/Part2p1.png)
- Что бы пользователь мог выполнять административные задачи добавляем его в группу adm командой
>       sudo usermod -aG adm user2
- результат команды
>       cat /etc/passwd
![id21](src/image/Part2p2.png)


Part 3. Настройка сети ОС
===========================
== Задание ==
--------------

- Задать название машины вида user-1
- Установить временную зону, соответствующую вашему текущему местоположению.
- Вывести названия сетевых интерфейсов с помощью консольной команды.
- В отчёте дать объяснение наличию интерфейса lo.
- Используя консольную команду получить ip адрес устройства, на котором вы работаете, от DHCP сервера.
- В отчёте дать расшифровку DHCP.
- Определить и вывести на экран внешний ip-адрес шлюза (ip) и внутренний IP-адрес шлюза, он же ip-адрес по умолчанию (gw).
- Задать статичные (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns (использовать публичный DNS серверы, например 1.1.1.1 или 8.8.8.8).
- Перезагрузить виртуальную машину. Убедиться, что статичные сетевые настройки (ip, gw, dns) соответствуют заданным в предыдущем пункте.
- В отчёте опишите, что сделали для выполнения всех семи пунктов (можно как текстом, так и скриншотами).
Успешно пропинговать удаленные хосты 1.1.1.1 и ya.ru и вставить в отчёт скрин с выводом команды. В выводе команды должна быть фраза "0% packet loss".

== Решение ==
--------------
- с помощью **vim** открываю файл
>       sudo vim ../../etc/hostname
- в файле меняем имя машины **user1**
![id31](src/image/Part3p2.png)
- смотрю текущие настройки даты и времени командой
>       timedatectl 
![id32](src/image/Part3p3.png)
- смотрю какие часовые пояса есть, командой
>       timedatectl list-timezones
![id34](src/image/Part3p4.png)
- меняю настройки командой
>       sudo timedatectl set-timezone Europe/Moscow
![id36](src/image/Part3p7.png)
- вывести список сетевых интерфейсов командой
>       ip link show
![id37](src/image/Part3p8.png)
- даю расшифровку **lo** - это интерфейс для отладки серверных программ локально на машине - localhost
- получаю ip адрес устройства используя консольную команду
>       ip addr show
В зависимости от типа подключения Ethernet-интерфейс подписывается следующим образом: **enp0s3**, eth0 ( если WiFi : wlp2s0, wlan0, цифры могут отличаться). В данном случае наш **ip 10.0.2.15**
![id38](src/image/Part3p9.png)
- даю расшифровку **DHCP - Dynamic Host Configuration Protocol** - протокол динамической настройки узла

- Для отображения **внешнегоip** необходимо установить специальную утилиту **Curl (Client URL)**. Для этого необходимо выполнить команду:
>       sudo apt-get install curl
- После установки запустить любую из комманд: 
>       curl ident.me   или curl ipecho.net/plain**
- в итоге мы видим наш внешний **ip адрес 195.133.239.83** 
![id310](src/image/Part3p11.png)
- вывожу на экран внутренний IP-адрес шлюза, он же ip-адрес по умолчанию командой
>       ip route 
- Можно сократить вывод командой
>       ip route | grep default
**наш ip адрес 10.0.2.2**
![id311](src/image/Part3p10.png)

- Что бы задать задать статичные настройки ip, gw, dns (использовать публичный DNS серверы, например 1.1.1.1 или 8.8.8.8) открываем файл **00-installer-config.yaml** в папке **../../etc/netplan**
![id312](src/image/Part3p17.png)

- После вносим изменеия в файл. Информацию в файл заносим из ранее вызваных команд шагами ранее. Поля - addresses, gateway - мной заданные статические адреса.
![id313](src/image/Part3p18.png)

- После делаем  **reboot** и видим что к интерфейсу **enp0s3** применились изменения
![id314](src/image/Part3p19.png)

- Дальше  пропингую удаленные хосты 1.1.1.1
![id315](src/image/Part3p20.png)

- Дальше  пропингую удаленные хосты 1.1.1.1
![id316](src/image/Part3p21.png)

Part 4. Обновление ОС
===========================
== Задание ==
--------------

- Обновить системные пакеты до последней на момент выполнения задания версии.
- Вставить скриншот с этим сообщением в отчёт.

== Решение ==
--------------

- Первым делом необходимо обновить вашу текущую версию дистрибутива командой 
>       sudo apt update
![id41](src/image/Part4p22.png)

- После обновиляем систему командой
>       sudo apt dist-upgrade
- Команда запускает обновление всех пакетов, видим отображение обновления в терминале. После **reboot** запускаем обновление еще раз и видим отсутсвие обновлений
![id42](src/image/Part4p23.png)

Part 5. Использование команды sudo
===========================
== Задание ==
--------------

-Разрешить пользователю, созданному в Part 2, выполнять команду sudo.

- В отчёте объяснить истинное назначение команды **sudo**
- Поменять **hostname** ОС от имени пользователя, созданного в пункте Part 2 (используя sudo).
- Вставить скрин с изменённым hostname в отчёт.

== Решение ==
--------------

- **sudo - substitute user and do** - команда, позволяющая подменить юзера и выполнить команду от его имени. По умолчанию команда sudo повышает привилегии до root
- Переход между user осуществляем командой
>       su user2
- Добавляем пользователя в группу **sudo** командой 
>       sudo usermod -aG sudo user2
- чтобы сделать изменения постоянными, нужно изменить содержимое двух файлов
- Открываем файл ***/etc/hostname** и меняем **user1** на **hostname-new**
- Открываем следущий файл **/etc/hosts**, меняем **adm** на **hostname**
![id43](src/image/Part5p11.png)
- Прикрепляю скрин изменений после **reboot**

![id44](src/image/Part5p12.png)


Part 6. Установка и настройка службы времени
===========================
== Задание ==
--------------

- Настроить службу автоматической синхронизации времени.
- Вывести время, часового пояса, в котором вы сейчас находитесь.
Вывод следующей команды должен содержать NTPSynchronized=yes: 
timedatectl show
- Вставить скрины с корректным временем и выводом команды в отчёт.

== Решение ==
--------------

- Включаем синхронизацию времени с помощью команды
>       sudo timedatectl set-ntp on
- Прикрепляю скриншот после команды
>       timedatectl show
![id45](src/image/Part6p11.png)

Part 7. Установка и использование текстовых редакторов
===========================
== Задание ==
--------------

- Установить текстовые редакторы VIM (+ любые два по желанию NANO, MCEDIT, JOE и т.д.)
- Используя каждый из трех выбранных редакторов, создайте файл test_X.txt, где X -- название редактора, в котором создан файл. Напишите в нём свой никнейм, закройте файл с сохранением изменений.
- В отчёт вставьте скриншоты:
- Из каждого редактора с содержимым файла перед закрытием.
- В отчёте укажите, что сделали для выхода с сохранением изменений.
- Используя каждый из трех выбранных редакторов, откройте файл на редактирование, отредактируйте файл, заменив никнейм на строку "21 School 21", закройте файл без сохранения изменений.
- В отчёт вставьте скриншоты:
- Из каждого редактора с содержимым файла после редактирования.
- В отчёте укажите, что сделали для выхода без сохранения изменений.
- Используя каждый из трех выбранных редакторов, отредактируйте файл ещё раз (по аналогии с предыдущим пунктом), а затем освойте функции поиска по содержимому файла (слово) и замены слова на любое другое.
- В отчёт вставьте скриншоты:
- Из каждого редактора с результатами поиска слова.
- Из каждого редактора с командами, введёнными для замены слова на другое.

== Решение ==
--------------

- Устанавливаем редактор **VIM** командой 
>       sudo apt-get install vim
- Устанавливаем редактор **NANO** командой
>       sudo apt-get install nano
- Устанавливаем редактор **MCEDIT** командой
>       sudo apt-get install mcedit

- Скриншот из редактора **VIM**, Для режима вставки нажимаем **i**, для возврата **Esc**. После изменений выходим из файла **:wq** для сохранения содержимого. 
![id46](src/image/Part7p11.png)
- Скриншот из редактора **NANO**. После изменений сочетанием клавиш сохраняем **Ctrl+o** и выходим из редактора **Ctrl+x** для сохранения содержимого. 
![id47](src/image/Part7p12.png)
- Скриншот из редактора **MCEDIT**. После изменений клавишей **F2** сохраняем и выходим из редактора клавишей **F10** для сохранения содержимого. 
![id48](src/image/Part7p13.png)

- Скриншот из редактора **VIM**. После изменений выходим из файла **:q!** без сохранения содержимого. 
![id49](src/image/Part7p14.png)
- Скриншот из редактора **NANO**. После изменений выходим из редактора **Ctrl+x** без сохранения содержимого. Редактор предложит выбрать **Y** или **N**.
![id50](src/image/Part7p15.png)
- Скриншот из редактора **MCEDIT**. После изменений выходим из редактора клавишей **F10** без сохранения содержимого. Редактор предложит выбрать **YES** или **NO**.
![id51](src/image/Part7p16.png)

- Скриншот из редактора **VIM**. Основные команды для поиска: **f** - найти один символ, **/** - искать несколько символов, **n** - найти следующее вхождение, **N** - найти предыдущее вхождение.
![id60](src/image/Part7p123.png)
- Для замены будет использоваться немного другая конструкция:
**:%s/искать/заменить/g**
![id61](src/image/Part7p124.png)

- Скриншот из редактора **NANO**. Осуществляем поиск через сочетание клавиш **Ctrl+W** - можно использовать регулярные выражения.
![id52](src/image/Part7p122.png)
- Осуществляем замену через сочетание клавиш **Alt+R**
![id53](src/image/Part7p121.png)

- Скриншот из редактора **MCEDIT**. Осуществляем поиск через клавишу **F7** - можно использовать регулярные выражения.
**Shift+F7** - Повтор последней операции поиска.
![id54](src/image/Part7p19.png)
- Осуществляем замену через клавишу **F4**
![id55](src/image/Part7p120.png)


Part 8. Установка и базовая настройка сервиса SSHD
===========================

== Задание ==
--------------

- Установить службу **SSHd**.
- Добавить автостарт службы при загрузке системы.
- Перенастроить службу SSHd на порт 2022.
- Используя команду ps, показать наличие процесса sshd. Для этого к команде нужно подобрать ключи.
- В отчёте объяснить значение команды и каждого ключа в ней.
- **Перезагрузить систему**
- В отчёте опишите, что сделали для выполнения всех пяти пунктов (можно как текстом, так и скриншотами).
- Вывод команды netstat -tan должен содержать  
tcp 0 0 0.0.0.0:2022 0.0.0.0:* LISTEN  
(если команды netstat нет, то ее нужно установить)
- Скрин с выводом команды вставить в отчёт.
- В отчёте объяснить значение ключей -tan, значение каждого столбца вывода, значение 0.0.0.0.

== Решение ==
--------------

- Устанавливаем **ssh** на рабочую машину с помощью команды 
>       sudo apt install openssh-server
- При установке **SSH-сервер** автоматически прописывается в автозагрузку. Управлять его запуском, остановкой или перезапуском можно с помощью команд:
>        sudo systemctl start|stop|restart ssh
- Проверить, что служба ssh.service работает:
>       systemctl is-active ssh
- Добавляем службу sshd в автозапуск, делаем это с помощью команды 
>       sudo systemctl enable ssh
- Что бы перенастроить службу SSHd на порт 2022 открываем файл и меняем **22** на **2022**
>       sudo vi ../../etc/ssh/sshd_config
![id59](src/image/Part8p11.png)
- Чтобы изменения вступили в силу - выполним рестарт системы командой:
>       sudo systemctl restart sshd
- Выводим статус службы командой
>       systemctl status sshd
![id65](src/image/Part8p12.png)
- Находим процесс с помощью команды ps использую дополнительные флаги:
>       ps -ef | grep sshd
![id66](src/image/Part8p14.png)
![id66](src/image/Part8p13.png)

- Даю расшифровку
Опция -e, показывает все процессы, а -f показывает полную информацию: UID - идентификатор пользователя выполняющего команду, PID - это идентификатор процесса команды, PPID - идентификатор родительского процесса, который отпустил команду, C - количество дочерних процессов, STIME - это время начала процесса, TTY, TIME, CMD.
Передаю  в **grep** паттерн  для фильтрации поиска **sshd**

- Результат выполнения команды 
>       netstat -tan
![id67](src/image/Part8p15.png)
- Даю расшифровку
-t отобразит только TCP, -a покажет все сокеты(слушаемые и нет) -n будет показывает численные адрес. 0.0.0.0 означает в данном случае любой адрес


Part 9. Установка и использование утилит top, htop
===========================

== Задание ==
--------------

- Установить и запустить утилиты top и htop.
- По выводу команды top определить и написать в отчёте:
1. uptime
2. количество авторизованных пользователей
3. общую загрузку системы
4. общее количество процессов
5. загрузку cpu
6. загрузку памяти
7. pid процесса занимающего больше всего памяти
8. pid процесса, занимающего больше всего процессорного времени
- В отчёт вставить скрин с выводом команды htop:
1. отсортированному по PID, PERCENT_CPU, PERCENT_MEM, TIME
2. отфильтрованному для процесса sshd
3. с процессом syslog, найденным, используя поиск
4. с добавленным выводом hostname, clock и uptime


== Решение ==
--------------
- Устанавливаем утилиты командами
>       sudo apt install top | sudo apt install top
- Запускаем команду
>       top
![id68](src/image/Part9p11.png)
- Окно после вывода можно условно разделить на две части. В верхней части находится информация о системе, общем использовании ресурсов процессора и памяти, раздела подкачки, и так далее. В нижней части окна расположен список запущенных процессов с информацией, отсортированных по определённому полю.
- Даю расшифровку командам
    1. uptime - **3 min (время в системе)**
    2. количество авторизованных пользователей - **user1**
    3. общую загрузку системы **(load average) - 1.10, 0.05, 0.01**
    4. общее количество процессов **(Tasks) - 107**
    5. загрузку cpu - **0**
    6. загрузку памяти **(MiB Mem) - 1975.8  Total**
    7. pid процесса занимающего больше всего памяти - **стобец %MEM PID 399**
![id70](src/image/Part9p12.png)

- Что бы посмотреть какой процесс занимает больше всего памяти воспользуемся клавишей **x**. Выделяет жирным колонку, по которой выполняется сортировка. Пемемещаться по колонке сортировки клавишами **<>**
    8. pid процесса, занимающего больше всего процессорного времени - **столбец TIME+ PID 728**
![id69](src/image/Part9p13.png)
- Запускаем команду
>       htop
![id671](src/image/Part9p14.png)
- Для сортировки используем клавишу меню **F6**
- Прикладываю скрины с сротировкой процессов по:

- PID

![id672](src/image/Part9p15.png)

- PERCENT_CPU

![id673](src/image/Part9p16.png)

- PERCENT_MEM

![id674](src/image/Part9p17.png)

- TIME

![id675](src/image/Part9p18.png)

- Для фильтрации  используем клавишу меню **F4**. Фильтр по **sshd**

![id676](src/image/Part9p19.png)

- Для фильтрации  используем клавишу меню **F3**. Фильтр по **syslog**

![id677](src/image/Part9p120.png)

- Для добавления hostname, clock и uptime нажимаем **F2** и в настройках добавляем необходимые атрибуты на дашборд утилиты. Скрин после изменений

![id68](src/image/Part9p121.png)

Part 10. Использование утилиты fdisk
===========================

== Задание ==
--------------

- Запустить команду fdisk -l.
- В отчёте написать название жесткого диска, его размер и количество секторов, а также размер swap.

== Решение ==
--------------

- Устанавливаем утилиту командами:
>       sudo apt update | sudo apt install fdisk
- После запускаем
>       sudo fdisk -l
![id678](src/image/Part10p11.png)
- название жесткого диска - **VBOX HARDDISK**
- размер - **5 Gib**
- количество секторов - **10485760**
- Посмотреть размер **swap** можно с помощью команды
>       free -h
![id679](src/image/Part10p12.png)
- размер swap - **0 Gib**

Part 11. Использование утилиты df
===========================

== Задание ==
--------------

- Запустить команду df.
- В отчёте написать для корневого раздела (/):
    1. размер раздела
    2. размер занятого пространства
    3. размер свободного пространства
    4. процент использования
- Определить и написать в отчёт единицу измерения в выводе.
- Запустить команду df -Th.
- В отчёте написать для корневого раздела (/):
    1. размер раздела
    2. размер занятого пространства
    3. размер свободного пространства
    4. процент использования
- Определить и написать в отчёт тип файловой системы для раздела.

== Решение ==
--------------
- Запускаем команду в терминале. После запускаем с флагом **-h**. Разница показывает состояние дисков в килобайтах и мегабайтах, гигабайтов.
>       df | df -h
![id80](src/image/Part11p11.png)
- Видим в отчете утилиты: 
    1. размер раздела- **Size - 8408452**
    2. размер занятого пространства - **Used - 4610892**
    3. размер свободного пространства - **Avail -  3348844**
    4. процент использования - **Use - 58%**
- Далее запускаем команду с флагом **-Th**. Разница показывает состояние дисков в килобайтах и мегабайтах, гигабайтов.
>       df -Th
![id81](src/image/Part11p12.png)
- Видим в отчете:
    1. размер раздела- **Size - 8.1G**
    2. размер занятого пространства - **Used - 4.5G**
    3. размер свободного пространства - **Avail -  3.2G**
    4. процент использования - **Use - 58%**
    5. тип файловой системы - **Type - ext4**

Part 12. Использование утилиты du
===========================

== Задание ==
--------------
- Запустить команду du.
- Вывести размер папок /home, /var, /var/log (в байтах, в человекочитаемом виде)
- Вывести размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя *)
- В отчёт вставить скрины с выводом всех использованных команд.

== Решение ==
--------------

- Для удобства считывания информации будем использовать утилиту **du** с флагом **-h**. Данный флаг показывает размер в единицах измерения удобных для человека.
- смотрим размер папки **/home - 128K**
>       du -h /home
![id82](src/image/Part12p11.png)
- смотрим размер папки **/var - 341M**
>       du -h /var
![id83](src/image/Part12p12.png)
- смотрим размер папки **/var/log - 76M**
>       du -h /var/log
![id84](src/image/Part12p13.png)
- смотрим размер каждого файла в папке **/var/log/\***
>       du -h /var/log/*
![id85](src/image/Part12p14.png)



Part 13. Установка и использование утилиты ncdu
===========================

== Задание ==
--------------
- Установить утилиту ncdu.
- Вывести размер папок /home, /var, /var/log.
- Размеры должны примерно совпадать с полученными в Part 12.
- В отчёт вставить скрины с выводом использованных команд.

== Решение ==
--------------
- Устанавливаем утилиту **ncdu**
>       sudo apt install ncdu
![id86](src/image/Part13p11.png)
- Смотрим размер папки  **/home**
>       ncdu /home
![id86](src/image/Part13p12.png)
- Смотрим размер папки  **/var**
>       ncdu /var
![id86](src/image/Part13p13.png)
- Смотрим размер папки  **/var/log**
>       ncdu /var/log
![id86](src/image/Part13p14.png)


Part 14. Работа с системными журналами
===========================

== Задание ==
--------------

- Открыть для просмотра:
1. /var/log/dmesg
2. /var/log/syslog
3. /var/log/auth.log
- Написать в отчёте время последней успешной авторизации, имя пользователя и метод входа в систему.
- Перезапустить службу SSHd.
- Вставить в отчёт скрин с сообщением о рестарте службы (искать в логах).

== Решение ==
--------------
- Смотрим что в логах через **cat**. Можно открыть лог любым тескстовым редактором, например  **vim**
>       cat /var/log/dmesg
-  этот лог содержит информацию о драйверах устройств.
![id99](src/image/Part14p11.png)
- смотрим дальше
>       cat /var/log/syslog
- содержит глобальный системный журнал, в котором пишутся сообщения с момента запуска системы, от ядра Linux, различных служб, обнаруженных устройствах, сетевых интерфейсов и много другого.
![id98](src/image/Part14p12.png)
- открываем последний. Он содержит информацию об авторизации пользователей, включая удачные и неудачные попытки входа в систему
>       cat /var/log/auth.log
![id97](src/image/Part14p13.png)
- Теперь посмотрим в логе **/var/log/auth.log** время поледней успешной авторизации и имя пользователя. Видим последний вход **user1 18 feb 16:56:16** по средством службы **systemd-logind**
>       cat /var/log/auth.log
![id96](src/image/Part14p15.png)
- Можно посмотреть командой **grep** совпанедние по имени юзера или способу входа. Пример:
>       grep systemd-logind /var/log/auth.log
![id96](src/image/Part14p14.png)
- Перезапускаем службу **sshd**
>       sudo systemctl restart ssh
- Смотрим в логах утилитой **grep** по паттерну **sshd**
>       grep ssh /vat/log/auth.log
![id95](src/image/Part14p16.png)


Part 15. Использование планировщика заданий CRON
===========================

== Задание ==
--------------
- Используя планировщик заданий, запустите команду uptime через каждые 2 минуты.
- Найти в системных журналах строчки (минимум две в заданном временном диапазоне) о выполнении.
- Вывести на экран список текущих заданий для CRON.
- Вставить в отчёт скрины со строчками о выполнении и списком текущих задач.
- Удалите все задания из планировщика заданий.
- В отчёт вставьте скрин со списком текущих заданий для CRON.

== Решение ==
--------------

- Первым делом обновляем пакеты, устанавливаем **Cron**
>       sudo apt update | sudo apt install cron
- Убедимся, что он настроен для работы в фоновом режиме:
>       sudo systemctl enable cron
![id84](src/image/Part15p11.png)
- После этого cron будет установлен в системе, а вы сможете начать составлять расписание задач

**команды управления cron**
| Команда         | Описание                                                               |
------------------|---------                                                               |
| crontab -e      | Редактирование или создание файла расписания для текущего пользователя |
| crontab -l      | Вывод содержимого расписания текущего пользователя                     |
| crontab -r      | Удаление файла расписания текущего пользователя                        |
| crontab -u user |  Работа с расписаниями конкретных пользователей                        |

- Запускаем файл с плинировщиком задач командой:
>       sudo crontab -e
- Первый запуск предложит выбрать текстовый редактор по умолчанию
- Прописываем в файле команду uptime через каждые 2 минуты используя синтаксис планировщика
![id93](src/image/Part15p12.png)
- Команда начинает выполняться после сохранения и выхода из файла. Смотрим через **cat** файл с записами выполнения команды в планировщике
>       cat /home/user1/tty.txt
![id92](src/image/Part15p13.png)
- В системных журналах смотрим строчки о выполнениих задач **CRON**
![id103](src/image/Part15p16.png)
- Вывожу список текущих заданий
>       crontab -l
![id101](src/image/Part15p14.png)
- Удалаяем все задания из планировщика и выводим текущий список задний командами:
>       crontab -r | crontab -l
![id102](src/image/Part15p15.png)